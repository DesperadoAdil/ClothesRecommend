webpackJsonp([1],{"+skl":function(t,a){},NHnr:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=e("7+uW"),s={name:"App",methods:{gohome:function(){router.push("/")}}},o={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{attrs:{id:"app"}},[a("Menu",{attrs:{mode:"horizontal",theme:"dark","active-name":"1"}},[a("MenuItem",{attrs:{name:"home","on-select":"gohome"}},[a("Icon",{attrs:{type:"ios-home"}}),this._v("\n      首页\n    ")],1)],1),this._v(" "),a("router-view")],1)},staticRenderFns:[]};var r=e("VU/8")(s,o,!1,function(t){e("nL59")},null,null).exports,i=e("/ocq"),c={name:"Main",data:function(){return{taskList:[],getTaskModal:!1,taskInfo:{},postTaskModal:!1,formInLine:{place:""},ruleInLine:{place:[{required:!0,message:"请输入地名",trigger:"blur"}]}}},mounted:function(){this.getTaskList()},methods:{getTaskList:function(){var t=this;this.$http.get("/api/task").then(function(a){for(var e=0;e<a.data.data.length;e++)t.taskList.push(a.data.data[e])}).catch(function(t){console.log(t)})},newTaskModal:function(){this.postTaskModal=!0},handleSubmit:function(t){var a=this;this.$refs[t].validate(function(t){if(t){var e={};e.place=a.formInLine.place,a.$http.post("/api/task",e=e).then(function(t){a.$Message.success("任务创建成功！"),a.ok()}).catch(function(t){console.log(t),a.$Message.error("任务创建失败！")})}else a.$Message.error("请输入正确地名！")})},getTask:function(t){var a=this;this.$http.get("/api/task/"+this.taskList[t].instance).then(function(t){a.getTaskModal=!0,a.taskInfo.ready=t.data.ready,a.taskInfo.state=t.data.state,a.taskInfo.id=t.data.data.id,a.taskInfo.instance=t.data.data.instance,a.taskInfo.place=t.data.data.place,a.taskInfo.create_time=t.data.data.create_time,1==t.data.ready&&(a.taskInfo.result=t.data.result)}).catch(function(t){console.log(t)})},deleteTask:function(){var t=this;this.$http.delete("/api/task/"+this.taskInfo.instance).then(function(a){t.$Message.success("任务删除成功！")}).catch(function(a){console.log(a),t.$Message.error("任务删除失败！")})},ok:function(){this.taskList=[],this.getTaskList()}}},l={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"main"},[e("Row",{staticStyle:{"margin-top":"20px"}},[e("Col",{attrs:{span:"2",offset:"5"}},[e("h1",[t._v("任务列表")])]),t._v(" "),e("Col",{attrs:{span:"2",offset:"18"}},[e("Button",{attrs:{type:"primary",shape:"circle",icon:"md-add"},on:{click:t.newTaskModal}},[t._v("新建任务")])],1)],1),t._v(" "),e("Row",{staticStyle:{"margin-top":"10px"}},[e("Col",{attrs:{span:"15",offset:"5"}},[e("Card",{staticStyle:{margin:"5px"},attrs:{bordered:!1}},[e("Row",[e("Col",{attrs:{span:"4"}},[t._v("任务id")]),t._v(" "),e("Col",{attrs:{span:"10"}},[t._v("任务实例id")]),t._v(" "),e("Col",{attrs:{span:"5"}},[t._v("任务状态")]),t._v(" "),e("Col",{attrs:{span:"5"}},[t._v("任务创建时间")])],1)],1),t._v(" "),t._l(t.taskList,function(a,n){return e("Card",{staticStyle:{margin:"5px"},attrs:{bordered:!1},nativeOn:{click:function(a){return t.getTask(n)}}},[e("Row",[e("Col",{attrs:{span:"4"}},[t._v(t._s(a.id))]),t._v(" "),e("Col",{attrs:{span:"10"}},[t._v(t._s(a.instance))]),t._v(" "),e("Col",{attrs:{span:"5"}},[t._v(t._s(a.state))]),t._v(" "),e("Col",{attrs:{span:"5"}},[t._v(t._s(a.create_time))])],1)],1)})],2)],1),t._v(" "),e("Modal",{attrs:{fullscreen:"",title:"任务详情"},on:{"on-ok":t.ok},model:{value:t.getTaskModal,callback:function(a){t.getTaskModal=a},expression:"getTaskModal"}},[e("p",[t._v("任务id："+t._s(t.taskInfo.id))]),t._v(" "),e("p",[t._v("任务实例id："+t._s(t.taskInfo.instance))]),t._v(" "),e("p",[t._v("地名："+t._s(t.taskInfo.place))]),t._v(" "),e("p",[t._v("任务创建时间："+t._s(t.taskInfo.create_time))]),t._v(" "),e("p",[t._v("任务状态："+t._s(t.taskInfo.state))]),t._v(" "),1==t.taskInfo.ready?e("div",[e("p",[t._v("任务结果：")]),t._v(" "),t._l(t.taskInfo.result,function(t,a){return e("div",[e("img",{attrs:{src:t}})])})],2):t._e(),t._v(" "),e("Button",{attrs:{type:"error",shape:"circle",icon:"ios-trash"},on:{click:function(a){return t.deleteTask()}}},[t._v("删除任务")])],1),t._v(" "),e("Modal",{attrs:{title:"创建任务"},on:{"on-ok":function(a){return t.handleSubmit("formInLine")}},model:{value:t.postTaskModal,callback:function(a){t.postTaskModal=a},expression:"postTaskModal"}},[e("Form",{ref:"formInLine",attrs:{model:t.formInLine,rules:t.ruleInLine,inline:""}},[e("FormItem",{attrs:{prop:"place"}},[e("Input",{attrs:{type:"text",placeholder:"地名"},model:{value:t.formInLine.place,callback:function(a){t.$set(t.formInLine,"place",a)},expression:"formInLine.place"}},[e("Icon",{attrs:{slot:"prepend",type:"ios-planet"},slot:"prepend"})],1)],1)],1)],1)],1)},staticRenderFns:[]};var p=e("VU/8")(c,l,!1,function(t){e("ctrV")},"data-v-85c2c7e6",null).exports;n.default.use(i.a);var d=new i.a({routes:[{path:"/",name:"Main",component:p}]}),u=e("BTaQ"),f=e.n(u),v=(e("+skl"),e("mtWM")),k=e.n(v),_=e("Rf8U"),h=e.n(_);n.default.config.productionTip=!1,n.default.prototype.$http=k.a,n.default.use(h.a,k.a),n.default.use(f.a),new n.default({el:"#app",router:d,components:{App:r},template:"<App/>"})},ctrV:function(t,a){},nL59:function(t,a){}},["NHnr"]);
//# sourceMappingURL=app.f745f7d3493f4d30824a.js.map